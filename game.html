<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alley Games</title>
    <link rel="stylesheet" href="assets/css/custom.css">
    <meta name="Keywords" content="">
    <meta name="Description" content="">
</head>
<body>
    <header>
        <div class="header-container">
            <div class="header-logo">
                <img src="assets/img/logo.png" alt="Alley">
                <span class="logo-text">Alley Games</span>
            </div>
            <div class="search-div">
                <img src="assets/img/search_icon.png" class="search-icon" alt="search-icon">
                <input type="text" class="search-box" name="search" id="search" placeholder="search..." autocomplete="off">
            </div>
            <div class="menu-div">
                <img src="assets/img/menu.png" class="menu-icon" id="toggle_menu" alt="menu-icon">
            </div>
        </div>
    </header>
    <div class="main-page">
        <section class="sidebar" id="sidebar">
            <ul class="category-list" id="cat_list">
                <span>Loading...</span>
            </ul>
        </section>
        <section class="games-container play-game">
            <iframe id="game" class="game-frame"></iframe>
        </section>
    </div>
    <div id="backdrop" class="backdrop"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/custom.js"></script>
    <script>
        $(document).ready(async function(){
            await getCategory();
            var game_link = localStorage.getItem('game-link');
            $("#game").prop('src', game_link+"?key=9gHj3sP5Kq7Rt4A1fBz0uXmN2vYc6DwE8iF7oLpQbVdSjCkMn");
        });

        

        async function getGames(type, cat_name = ""){
            $.ajax({
                type: "POST",
                url: "https://gamersaim.com/Apis/games_spot_web/category_by_data.php",
                data: {type:type, category:cat_name},
                dataType: 'json',
                async: true,
            }).done(function (response) {
                console.log(response);
                var gameData = response;
                var game_html = "";
                gameData.forEach(function(game){
                    game_html += `<div class="game-item" onclick="openGame('${game.gamelink}');">
                                    <img src="${game.img}" alt="game1">
                                </div>`;
                });
                $("#game_list").html(game_html);
            });
        }

        async function openGame(gamelink){
            localStorage.setItem('game-link', gamelink);
            window.location.href = 'game/123';
        }
    </script>
</body>
</html>